pipeline{
	agent any{
		stages{
			stage('Sonarqube Analysis'){
				steps{
					withSonarQubeEnv('sonarqube'){
						sh 'mvn clean package sonar:sonar'
					}
				}
			}
			
			stage('Quality Gate'){
				steps{
					timeout(time: 5, unit: 'MINUTES'){
						waitForQualityGate abortPipeline: true
					}
				}
			}
			
			stage('Build'){
				steps{
					sh 'mvn -B -DskipTests clean package'
				}
			}
		}
	}
}